# 16n Firmware 2.0.0

The main goal of this is to extract configuration from Arduino to a web UI.


## INSTRUCTIONS

The main goal of 16n firmware 2.0.0 is to extract configuration to a web-based UI. No more editing crap in Arduino to change the configuration of your device!

### Installing Firmware 2.0.0

The most reliable way to install Firmware 2.0.0 is to load a compile binary with Teensy Loader.

Although this app is inside your Arduino install (if you have one) it's probably easiest just to download a new version:

https://www.pjrc.com/teensy/loader.html

Pick the version for your OS. You just need the "Teensy Loader application".

Run Teensy Loader. 

Open the v200a firmware hex file you've been given in Teensy Loader, either by dragging it on to the loader, or with File -> Open Hex File.

Connect your 16n over USB. Now, _push the reset button on the Teensy on the 16n_. This is the button at the far right of the Teensy board. This is quite easy to do with a ruler, or other flat object - eg a screwdriver blade - providing you have open sides on your case. When you push the button, the firmware will flash and your 16n will reboot.

### Configuring Firmware 2.0.0

https://16n-faderbank.github.io/editor/

You'll need to visit this editor in Google Chrome. That's the only browser it works on.

By default, you can see the controller as connected over USB, and manipulate your faders to see the debug-view move.

To alter the configuration, click "Edit Config" top right. You'll now be in Edit Mode. There are three tabs, for the USB output, the TRS output, and Other Options. Adjust each tab to the options you would like.

On Other Options, you can set I2C master mode, adjust the function of the LED, and rotate the controller outputs. The "fader minimum/maximum" numbers are only to adjust if you're not getting a maximum read value out of your faders. I should probably hide them.

When you've got the config you want, click "Update controller" to transmit the new config to the device. It will load immediately, and you'll be back at the debug view.

You can save the current config by clicking "Export current config". You'll download a JSON file with the current config in.

To load a previous config, click "Edit config", and then choose "Import config". Select the JSON config file you have previously made. If the file is different to the config, you'll be notified, and you can transmit it to the 16n with the "Update Controller" button.

That's it!

### Using firmware 2.0.0 with "v1.25" boards

If you're using a 16n _without_ a multiplexer - ie, v1.25 or earlier - this firmware should still work. You'll need to compile it with the `V125` toggle in `config.h` set to `1`. The editor should then work correctly.

## TODO

* import 1.3.5 i2c upgrade

## DONE

* test EEPROM read
* write defaults to EEPROM
* populate board config from EEPROM
* handle inbound Sysex Requests with callback
  * dumping to Serial
* respond with existing config over Sysex
* handle updating config over Sysex
* latest LEDblink code
* correctly handle FLIP
* Add memory map to README
* Add configuration instructions to README
* minfader/maxfader config via app
* i2c master config via app
* extract app to own repo in 16nland.
* tidy App.svelte again
  * strip val from import/export
  * update app with unique 16n features
  * tidy App console dumps
* deploy app SOMEWHERE? (could build to /config)
* Walkthrough / demo of editor
